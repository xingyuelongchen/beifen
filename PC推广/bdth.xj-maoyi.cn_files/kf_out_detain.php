		var html = "<div class=\"kf53kf_walnut_masking\"></div><div class=\"kf53kf_lucency_remind\" style=\"z-index: 999999999;position: fixed;left: 0;top: 50%;margin-top:-18px;height: 36px;width: 100%;text-align: center;display: none\"><span class=\"kf53kf_lucency_alert\" style=\"height: 36px;line-height: 36px;padding: 0 15px 0;font-size: 14px;background-color:rgba(0,0,0,0.7);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#B2000000,endColorstr=#B2000000); color:#fff;border-radius:2px;letter-spacing: 0.5px;\"></span></div><div style=\"position:fixed;width:100%;height:100%;background-color: rgba(15, 1, 0, 0.7);z-index:88888888\"><div style=\"background: #fff;width: 560px;height: 320px;box-sizing: border-box; position: fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,1);border-radius:3px;z-index:1000001;\"><div style=\"position:absolute;right:5px;top:5px;width:16px;height:16px;cursor:pointer;z-index:5;\" onclick=\"P.close();\"><svg height=\"16\" viewBox=\"0 0 16 16\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"none\" fill-rule=\"evenodd\"><path d=\"m0 0h16v16h-16z\"/><path d=\"m14.25 2.808-1.057-1.058-5.193 5.192-5.192-5.192-1.058 1.058 5.192 5.192-5.192 5.193 1.058 1.057 5.192-5.193 5.193 5.193 1.057-1.057-5.193-5.193z\" fill=\"#466080\"/></g></svg></div><div class=\"kf53kf_pc_unsuccess\"><div style=\"width: 272px;height: 320px;display:flex;align-items:center;margin:0;\"><img  style=\"width: 100%;\" class=\"kf53kf_img_preview\" src=\"http://s0up.53kf.com/g1/M00/00/64/wKhvsV4ZPGyAB7UAAAA44svaEtk748.png\" alt=\"\" /></div><div class=\"inv_box_right\" style=\"width: 240px;position: absolute;top: 50%;left: 296px;transform: translate(0, -50%);\"><div><div><p style=\"width:240px;max-height: 72px; line-height: 36px;font-size:24px;font-weight:500;color:rgba(68,68,68,1);-webkit-line-clamp: 2;margin-bottom:8px;display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden;\">火速领 开网店秘籍！</p></div></div><div><div style=\"width:240px; min-height: 20px; max-height:40px;line-height: 20px;font-size:14px;font-weight:400;color:rgba(141,162,181,1);-webkit-line-clamp: 2;display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden;\">秘籍将通过短信发送至您手机。</div></div><div class=\"kf53kf_list_right_tips\" style=\"position: absolute;bottom: 88px;left:50%;transform: translateX(-50%);display: none;\"><div style=\"background:rgba(244,64,36,0.9);\"><div class=\"kf53kf_list_right_text\" style=\"height:28px;background:rgba(244,64,36,0.9);border-radius:2px;font-size:12px;font-weight:400;margin:0 10px;color:rgba(255,255,255,1);line-height: 28px;text-align: center;box-sizing: border-box;white-space: nowrap;\"></div></div><div style=\"width: 0;height: 0;border-top: 5px solid rgba(245,83,57,1);border-left: 6px solid transparent;border-right: 6px solid transparent;margin: 0 auto;\"></div></div><div style=\"margin: 16px 0 8px 0\"><input class=\"kf53kf_right_input_phone\"  placeholder=\"手机号码\" style=\"display:inline-block;color: initial;padding-left: 4px;width:240px;height:32px;background:rgba(255,255,255,1);border-radius:2px;border:1px solid rgba(206,213,224,1);font-size:12px;line-height: 32px;box-sizing: border-box;\"></div><div class=\"kf53kf_list_right_tips_msg\" style=\"position: absolute;bottom: 88px;left:50%;transform: translateX(-50%);display: none;\"><div style=\"background:rgba(244,64,36,0.9);\"><div class=\"kf53kf_list_right_text_msg\" style=\"height:28px;background:rgba(244,64,36,0.9);border-radius:2px;font-size:12px;font-weight:400;margin:0 10px;color:rgba(255,255,255,1);line-height: 28px;text-align: center;box-sizing: border-box;white-space: nowrap;\"></div></div><div style=\"width: 0;height: 0;border-top: 5px solid rgba(245,83,57,1);border-left: 6px solid transparent;border-right: 6px solid transparent;margin: 0 auto;\"></div></div><div style=\"display:none;\"><input class=\"kf53kf_right_input_phone_msg\"  placeholder=\"验证码\" style=\"display:inline-block;width:147px;height:32px;padding-left:4px;box-sizing: border-box;border: 1px solid rgba(206,213,224,1);line-height: 32px;font-size: 13.3px;margin-right:8px;\"/><span class=\"kf53kf_send_code\" onclick=\"P.sendCode();\" style=\"display:inline-block;width:85px;height:32px;border-radius:2px;font-size:12px;line-height:32px;text-align:center;cursor:pointer;color:#fff;\">获取验证码</span></div><a onclick=\"P.form(event);\" target=\"_blank\"><div  style=\"text-align:center;margin-top: 16px;width:240px;height:40px;border-radius:2px;cursor:pointer;padding:0 24px;box-sizing: border-box;\" class=\"kf53kf_click_btn\"><span style=\"font-size:16px;font-weight:400;color:rgba(255,255,255,1); width: 192px; line-height: 40px;float:left;overflow: hidden; text-overflow:ellipsis; white-space: nowrap;\" >接收资料</span></div></a></div></div><div style=\"height:18px;line-height:18px;color:rgba(255,255,255,0.6);position: absolute;bottom: -18px;font-size: 12px;right: 0px;\"><a class=\"kf53kf_right_title_msg\" target=\"_blank\" href=\"https://www.53kf.com\">53KF 提供产品支持</a></div></div></div>";
		var show_count = parseInt("5");
		var kf_rule_stay = "1" * 1000;
		var out_detain_have_phone = 0;

		$53.creElm({
			'id':'kfoutdetainwin',
			'style':'display:none;overflow:visible;',
			'innerHTML':html
		},'div');

		var oWidth = document.documentElement.clientWidth;
		var oHeight = document.documentElement.clientHeight;		document.addEventListener('mousemove',kf53kfMouseLeave);
		function kf53kfMouseLeave(){//鼠标移出
			var e = event || window.event;
			var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
			var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
			var x = e.clientX;
			var y = e.clientY;
			if(y<=4||x<=4||x>=oWidth-5||y>=oHeight-5){
				P.show();
			}
		}		var show_out_detain_timer = setTimeout(function(){
			P.rule_stay_open = '0';
			P.show();
		},kf_rule_stay);
		document.addEventListener('scroll',kf53kfScroll);
		function kf53kfScroll(){
			var rolTop =  document.documentElement.scrollTop||document.body.scrollTop;
			var rolHeight = document.documentElement.scrollHeight;
			var num = 0;
			num = rolTop/(rolHeight-window.innerHeight);
			num = parseInt(num*100);//滚轮百分比
			if(num>parseInt("0")){
				P.show();
				document.removeEventListener("scroll", kf53kfScroll);
			}
		}		var Preview = function(){
			this.pc_left_sector = document.querySelectorAll('.kf53kf_left_sector');
			this.priceName='';//获奖项目名称
			this.oPrice = document.querySelectorAll('.kf53kfpriceName');
			this.right_input_phone = document.querySelectorAll('.kf53kf_right_input_phone');
			this.list_right_text = document.querySelectorAll('.kf53kf_list_right_text');
			this.right_input_phone_msg = document.querySelectorAll('.kf53kf_right_input_phone_msg');
			this.list_right_text_msg = document.querySelectorAll('.kf53kf_list_right_text_msg');
			this.send_code_btn = document.querySelectorAll('.kf53kf_send_code');
			this.oUnsuccess = document.querySelectorAll('.kf53kf_pc_unsuccess');
			this.oSuccess = document.querySelectorAll('.kf53kf_pc_success');
			this.oRemind = document.querySelectorAll('.kf53kf_lucency_remind');
			this.oAlert = document.querySelectorAll('.kf53kf_lucency_alert');
			this.alert_flag = true;
			this.is_click = false;
			this.device = "pc";
			this.out_type = "4";
			this.rule_stay_open = "1";
			this.lang = ["\u624b\u673a\u53f7\u7801","\u7a0d\u540e\u5de5\u4f5c\u4eba\u5458\u4f1a\u4e0e\u60a8\u8054\u7cfb!","\u7ee7\u7eed\u6d4f\u89c8","\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u53f7\u7801","\u8be5\u624b\u673a\u53f7\u5df2\u53c2\u4e0e","\u9a8c\u8bc1\u7801","\u83b7\u53d6\u9a8c\u8bc1\u7801","\u91cd\u65b0\u83b7\u53d6","53KF \u63d0\u4f9b\u4ea7\u54c1\u652f\u6301","\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a","\u9a8c\u8bc1\u7801\u9519\u8bef"];
			this.captcha = "0";
			this.code = '';
			this.init();
			let _that = this;
			var style = document.createElement("style");
			document.head.appendChild(style);
			sheet = style.sheet;
			var isIE =  (function IEVersion() {
				var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串  
				var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器  
				var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器  
				var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1;
				if(isIE) {
					var reIE = new RegExp("MSIE (\d+\.\d+);");
					reIE.test(userAgent);
					var fIEVersion = parseFloat(RegExp["$1"]);
					if(fIEVersion == 7) {
						return 7;
					} else if(fIEVersion == 8) {
						return 8;
					} else if(fIEVersion == 9) {
						return 9;
					} else if(fIEVersion == 10) {
						return 10;
					} else {
						return 6;//IE版本<=7
					}   
				} else if(isEdge) {
					return 'edge';//edge
				} else if(isIE11) {
					return 11; //IE11  
				}else{
					return -1;//不是ie浏览器
				}
			})()
			sheet.insertRule('.kf53kf_pc_unsuccess input, .kf53kf_mobile_unsuccess input{border-color: #CED5E0;border-radius: 2px; }',0);
			sheet.insertRule('.kf53kf_pc_unsuccess input:focus, .kf53kf_pc_unsuccess textarea:focus,.kf53kf_mobile_unsuccess input:focus{border: 1px solid #A3B1C7!important; }',0);
			sheet.insertRule('.kf53kf_send_code, .kf53kf_click_btn{background: #3B99FC; border-color: #3B99FC;}',0);
			sheet.insertRule('.kf53kf_send_code:hover, .kf53kf_click_btn:hover{background: #53A5FC; border-color: #53A5FC; }',0);
			sheet.insertRule('.kf53kf_send_code:active, .kf53kf_click_btn:active{background: #358AE6!important; border-color: #358AE6!important;}',0);
			sheet.insertRule('.kf53kf_right_title_msg{text-decoration:none;color:inherit}',0);
			sheet.insertRule('.kf53kf_right_title_msg:hover{text-decoration: underline}',0);
			if(isIE==-1){
				sheet.insertRule('.kf53kf_pc_unsuccess input::-webkit-input-placeholder,.kf53kf_mobile_unsuccess input::-webkit-input-placeholder{ color: #8DA2B5; }',0);
			}else{
				sheet.insertRule('.kf53kf_pc_unsuccess input:-ms-input-placeholder,.kf53kf_mobile_unsuccess input:-ms-input-placeholder{ color: #8DA2B5; }',0);
			}
			sheet.insertRule('.kf53kf_pc_unsuccess p{ margin:0;padding:0 }',0);

			sheet.addRule('.kf53kf_pc_unsuccess input,.kf53kf_mobile_unsuccess input','outline: none');

			if(_that.right_input_phone.length>0){
				_that.right_input_phone[0].onfocus = function(){
					_that.right_input_phone[0].style.borderColor = "rgba(206,213,224,1)";
				};
				_that.right_input_phone_msg[0].onfocus = function(){
					_that.right_input_phone_msg[0].style.borderColor = "rgba(206,213,224,1)";
				};
				_that.right_input_phone[0].addEventListener("input", function(e) {
					this.value = this.value.replace(/[^\d]/g,""); //清除“数字”以外的字符
				});
				_that.right_input_phone_msg[0].addEventListener("input", function(e) {
					this.value = this.value.replace(/[^\d]/g,""); //清除“数字”以外的字符
				});
			
			}
		};
		Preview.prototype = {
			init : function(){
				for(var index=0;index<this.pc_left_sector.length;index++){
					let item = this.pc_left_sector[index];
					item.style.transform = "rotateZ("+ (index*45-22.5) +"deg)";
					if(index%2>0){
						item.style.borderRightColor = "rgba(255,229,42,1)";  
						item.children[0].setAttribute("style","color:rgba(244,64,36,1);width: 102px;line-height: 24px;font-size: 16px;font-weight: 400;margin-left: 60px;margin-top: -24px;display: -webkit-box; -webkit-box-orient: vertical;-webkit-line-clamp: 2;overflow: hidden;word-wrap: break-word;");
					}
				};
			},
			//居中状态弹框
			lucencyAlert : function(str,s){
				var _this = this;
				s = s || 1500;
				if(_this.alert_flag){
					_this.alert_flag = false;
					_this.oRemind[0].style.display = "block";
					_this.oAlert[0].style.display = "inline-block";
					_this.oAlert[0].innerHTML = str;

					let timer = setTimeout(function(){
						_this.oRemind[0].style.display = "none";
						_this.oAlert[0].style.display = "none";
						clearTimeout(timer);
						_this.alert_flag = true;
					},s);
				}
			},
			show : function() {
				if (out_detain_have_phone == 1) return;
				if (!this.is_click && $53("kfoutdetainwin").style.display == 'none') {
					var cookie_name = 'out_detain_num'+'72217608'+'_'+'106731466';
					var out_detain_num = $53.getCookie(cookie_name);
					if (out_detain_num == '') out_detain_num = 0;
					out_detain_num++;
					if (out_detain_num > show_count) return;

					document.cookie = cookie_name+"=" + out_detain_num + ";path=/";
					$53("kfoutdetainwin").style.display = "block";

					if (this.out_type == '3') {
						this.sendInfo('show');
					}
				}
				try{
					clearTimeout(show_out_detain_timer);
				}catch(e){}
			},

			close : function() {
				$53("kfoutdetainwin").style.display = "none";
				if (this.rule_stay_open == '1') {
					try{
						clearTimeout(show_out_detain_timer);
					}catch(e){}
					var show_out_detain_timer = setTimeout(function(){
						P.rule_stay_open = '0';
						P.show();
					},kf_rule_stay);
				}
			},
			testphone : function(){
				var _this =  this;
				_this.right_input_phone[0].style.borderColor = "rgba(206,213,224,1)";
				_this.right_input_phone_msg[0].style.borderColor = "rgba(206,213,224,1)";

				mobil_reg = /^1[3456789]\d{9}$|^09\d{8}$|^[5689]\d{7}$/;
				var phone = _this.right_input_phone[0].value;
				if(phone==""||!mobil_reg.test(phone)){
					let oBottom = _this.right_input_phone_msg[0].parentElement.style.display == "block" ? "137px" : "88px";
					_this.list_right_text[0].innerHTML = _this.lang[3];//号码不能为空
					if(!mobil_reg.test(phone)){
						_this.list_right_text[0].innerHTML = _this.lang[4];//请输入正确的号码
					}
					_this.right_input_phone[0].style.borderColor = "rgba(244,64,36,1)";
					return '';
				}
				return phone;
			},
			testcode : function(){
				var _this = this;
				let code = _this.right_input_phone_msg[0].value;
				if(code == ""){
					_this.right_input_phone_msg[0].style.borderColor = "rgba(244,64,36,1)";
					_this.list_right_text_msg[0].innerHTML = _this.lang[10];//验证码不能为空
					return false;
				}
				this.code = code;
				return true;
			},
			sendCode : function(){
				let codeStatus = parseInt(this.send_code_btn[0].innerHTML);
				if(codeStatus > -1){
					this.send_code_btn[0].style.cursor="pointer";
					return
				}
				var phone = this.testphone();
				if (phone) {
					this.sendInfo('captcha',phone);
				}
			},
			prize : function(event){
				event.stopPropagation();
				var phone = this.testphone();
				if (phone) {
					if (this.captcha == '1') {
						if (!this.testcode()) return;
					}
					this.sendInfo('check',phone);
				}
			},
			form : function(event){
				event.stopPropagation();
				var phone = this.testphone();
				if (phone) {
					if (this.captcha == '1') {
						if (!this.testcode()) return;
						this.sendInfo('check_code',phone);
					}else{
						this.sendInfo('click',phone);
					}
				}
			},
			down : function(event){
				event.stopPropagation();
				var phone = this.testphone();
				if (phone) {
					if (this.captcha == '1') {
						if (!this.testcode()) return;
						this.sendInfo('check_code',phone);
					}else{
						this.sendInfo('click',phone);
					}
				}
			},
			jump : function() {
				this.sendInfo('click');
			},
			sendInfo : function(action,mobile,prize_name){
				var _this = this;
				if (mobile == undefined) mobile = '';
				if (prize_name == undefined) prize_name = '';
				var callBackFunName = "out_detain_callback_"+new Date().getTime();
				eval(callBackFunName + '= function(data){_this.createResult(data)}');
				var url = "https://www4.53kf.com/client/clientOutDetain.php?company_id=72217608&guest_id=10014387047039&style=2&style_id=106731466&out_id=1010016&device=pc&referer=http%3A%2F%2Fbdth.xj-maoyi.cn%2F%3Fbd_vid%3D7247123611160737826&keyword=&talktitle=&out_type="+_this.out_type+"&action="+action+"&prize_name="+encodeURIComponent(prize_name)+"&mobile="+mobile+"&code="+_this.code+"&callback="+callBackFunName;
				var id = 'kf_script_'+$53.counter;
				$53.createScript(id,url);
				$53.counter++;
				if (action == 'click' && _this.out_type!='1') {
					this.is_click = true;
					this.close();
				}
			},
			createResult:function(data){
				var _this = this;
				if(data.code == 200){
					if (data.info == 'captcha'){
						_this.send_code_btn[0].innerHTML = 60+'s';
						var time_val = 60;
						let timer = setInterval(function(){
							time_val -- ;
							_this.send_code_btn[0].innerHTML = time_val+'s';
							if(time_val == 0){
								_this.send_code_btn[0].innerHTML = _this.lang[8];//重新获取
								clearInterval(timer);
							}
						},1000);
						return;
					} 
					var phone = _this.right_input_phone[0].value;
					if (_this.out_type == '1') {
						if (data.info == 'ok') {
							if (_this.captcha != '1') {
								_this.runTable();
								_this.oPrice[0].innerHTML = _this.priceName;
								_this.sendInfo('click',phone,_this.priceName);
							}else{
								_this.sendInfo('check_code',phone);
							}
						}else if(data.info == 'check_code'){
							_this.runTable();
							_this.oPrice[0].innerHTML = _this.priceName;
							_this.sendInfo('click',phone,_this.priceName);
						}else{
							this.is_click = true;
							setTimeout(function(){
								_this.oUnsuccess[0].style.display = 'none';
								_this.oSuccess[0].style.display = 'block';
							},3000);
						}
					}else if (_this.out_type == '2') {
						if(data.info == 'check_code'){
							_this.sendInfo('click',phone);
						}else{
							var url = "https://www4.53kf.com/client/clientOutDetain.php?company_id=72217608&guest_id=10014387047039&out_type=2&action=down&out_id=1010016";
							this.openDownWin(url);
						}
					}else if (_this.out_type == '4') {
						if(data.info == 'check_code'){
							_this.sendInfo('click',phone);
						}
					}
				}else{
					if (data.code == 202) {
						this.lucencyAlert(_this.lang[5]);
					}else if(data.code == 207){
						_this.right_input_phone_msg[0].style.borderColor = "rgba(244,64,36,1)";
						_this.list_right_text_msg[0].innerHTML = _this.lang[11];//验证码错误
					}else{
						this.lucencyAlert(data.info);
					}
					this.is_click = false;
				}
			},
			getRndInteger : function(min, max) {//返回 min（包含）～ max（包含）之间的数字：
				return Math.floor(Math.random() * (max - min + 1) ) + min;
			},

			openDownWin : function(url) {
				var div=document.createElement("div");
				div.innerHTML='<a href="'+url+'" target="_blank" id="openDownWin53"></a>';
				document.body.appendChild(div);
				document.getElementById("openDownWin53").click();
				document.getElementById("openDownWin53").remove();
			},
			runTable : function(){//点击旋转转盘 //set=1表示移动端set=0pc端
				var lottery = [];//奖品规则 概率
				var sumRate = 0;
				for(let i=0;i<8;i++){
					var rate = document.querySelectorAll('.kf53kf_left_sector')[i].getAttribute('rate');
					rate = Number(rate);
					sumRate += rate;
					lottery.push({'location':i,'rate':rate});
				}
				if (this.device == 'pc') {
					var circle_box = document.querySelectorAll('.kf53kf_circle_box');
				}else{
					var circle_box = document.querySelectorAll('.kf53kf_phone_reward_circle');
				}
				
				let randomRate = this.getRndInteger(0,sumRate);
				// 根据随机数，得到中奖结果
				var num = 0;
				var location = 0;
				for (let i=0; i < lottery.length;i++) {
					num+=lottery[i].rate;
					if(randomRate < num){
						this.priceName = document.querySelectorAll('.kf53kf_left_sector span')[i].innerHTML;
						location = i;
						break;
					}
				}
				// 2. 计算旋转角度, 需要多转5圈，达转1圈用时1s, 到旋转的效果
				let rotateItemDeg = (8-location) * 45+22.5; // 每个item旋转角度, 第一个不用旋转
				if (this.device == 'mobile') {
					rotateItemDeg = (2-location) * 45+22.5;
				}
				
				let rotate = rotateItemDeg + 5 * 360;
				let rotateSpeed = (rotateItemDeg / 360 * 1 + 5).toFixed(2);
				// 重置转盘样式
				circle_box[0].style.transform="rotate(0deg)";
				
				// 保证下一次旋转动画生效
				setTimeout(function() {
					circle_box[0].style.transform = "rotate(" + rotate+ "deg)";
					circle_box[0].style.transition = rotateSpeed+"s ease-out";
				}, 1);
			}
		};
		var P = new Preview();
		window.P = P;